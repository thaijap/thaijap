<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Cuisine - ThaiJap</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body style="background:#1a1a1a; color:white; padding:20px;">
    <h1>ğŸ‘¨â€ğŸ³ Commandes ThaiJap</h1>
    <div id="admin-grid" class="grid"></div>
    <audio id="notif" src="https://assets.mixkit.co/active_storage/sfx/2869/2869-preview.mp3"></audio>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyCiqOVjzAS5Crn4SPBkY3btyJtuCBgddpY",
            databaseURL: "https://thaijap-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "thaijap",
            appId: "1:84821188454:web:0078ba82b4affbe0abb2a7"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        let count = 0;
        db.ref('commandes').on('value', (snap) => {
            const data = snap.val();
            if(data && Object.keys(data).length > count) document.getElementById('notif').play().catch(e=>{});
            count = data ? Object.keys(data).length : 0;

            const container = document.getElementById('admin-grid');
            container.innerHTML = "";
            for(let id in data) {
                const o = data[id];
                container.innerHTML += `
                    <div class="order-card ${o.statut==='PrÃªte'?'ready':''}" style="background:white; color:black; margin:10px; padding:15px; border-radius:10px;">
                        <h3>TABLE ${o.table} <small>(${o.heure})</small></h3>
                        <ul>${o.articles.map(a=>`<li>${a.nom}</li>`).join('')}</ul>
                        <button class="btn-ready" onclick="db.ref('commandes/${id}').update({statut:'PrÃªte'})">PRÃŠTE</button>
                        <button class="btn-del" onclick="if(confirm('Supprimer?'))db.ref('commandes/${id}').remove()">X</button>
                    </div>`;
            }
        });
    </script>
</body>
</html>